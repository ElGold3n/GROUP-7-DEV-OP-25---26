name: A workflow for DevOps Group 7

on: push

jobs:
  build:
    name: devopsGroup Actions
    runs-on: ubuntu-22.04

    steps:
      - name: Checkout
        uses: actions/checkout@v4

      # If you need Java build first (Maven/Gradle)
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'adopt'

      - name: Build with Maven
        run: mvn -B package --file pom.xml

      # Build the Docker image for the webapp
      - name: Build webapp container
        run: docker build -t webapp:latest .

      # Run docker compose and wait for containers to finish
      - name: Run docker compose
        run: docker compose up --abort-on-container-exit --build